---
title: 按字节/字寻址，字长，地址总线，数据总线关系
tags: 
categories:
- linux
---
设一个1MB容量的存储器，字长为32位，问：

1）按字节编址，地址寄存器和数据寄存器个几位？

2）按字编址，地址寄存器和数据寄存器个几位？


答案是：
1）1MB=2^20×8 位，地址寄存器为20位，数据寄存器为8位

2）1MB=2^18×32 位，地址寄存器为18位，数据寄存器为32位



我的理解：
字长是CPU一次处理数据也就是读取和写数据的长度(等于数据总线)，与按字编址(每个存储单元长度bit)是不同的概念
按字节编址(寻址)每个存储单元8bit
按字编址(32bit)每个存储单元32bit

	1. 按字节编址，字长需要出题人根据心情随意给出比如16位，则CPU一次读写32bit的数据，存储容量1MB
		存储容量1MB = 2^20*8bit = 2^19*16bit, 则地址总线19根，数据总线16根
		也就是地址寄存器19位，数据寄存器16位
	2. 按字节编址(8bit)，字长32bit
		CPU一次读写4个内存地址空间数据
	3. 按字编址(32bit)，字长32bit
		CPU一次读写1个内存地址空间数据

CPU的地址总线是由其通用寄存器的地址总线决定
我们生活中的笔记本电脑一般CPU通用寄存器的地址总线和数据总线都为32bit
因为我们笔记本电脑内存4GB，字长32bit，一般(如果不指明默认情况下)都是按字节编址(寻址)
	1. 字长32bit因此确定数据总线为32根
	2. 4GB = 2^32*8bit, 因此地址总线32根


如下图:
![](address.png)
	
地址00h直接跳到04h, 后缀h,前缀0x代表16进制，每一行32bit，说明：
	1. 字长32bit
	2. 按字节寻址
	因此CPU一次处理读写4个地址空间数据如地址00h~03h


32位的处理器(CPU)强调的是数据总线的宽度，32位操作系统强调的是地址总线的宽度, 然后默认按字节寻址(8bit)则只能支持4GB大小内存, 地址总线确定最大可寻址内存范围.

32位cpu，应该说清楚是cpu的地址总线位宽为32位的时候最大只能支持4G的寻址，所以只能支持4G。 如果这里的32位CPU指的是数据总线位宽就不能说明最大可以使用4G内存。 另外，还受制于操作系统的位数，如果操作系统是32位就意味着逻辑地址寻址范围在4G以内，这样就算是64位地址总线也无法使用4G以上的内存空间。

百度百科里32位处理器和32位操作系统都和4G内存扯上了关系。说明32位处理器的地址总线宽度是32位，32位操作系统的地址总线宽度也是32位。


CPU在执行指令时需要先将指令的逻辑地址变换为物理地址才能执行。
	地址总线数目	最大支持内存
32位系统	32	2的32次方 = 4G
64位系统	36或40	2的36次方 = 64G 或 2的40次方= 1024G = 1T


问题：
• 自己装的是4G内存条，可是操作系统显示的内存却是3.75G
• 自己装的是8G内存条，可是操作系统显示的内存也是3.75G
在使用计算机时，其支持的最大内存是由操作系统和硬件两方面决定的。
实际上用户在使用计算机时，进程访问到的地址都是逻辑地址，并不是真实的物理地址，逻辑地址是由操作系统提供的，并维护了逻辑地址和物理地址的映射
对于32位的windows操作系统，提供的逻辑地址寻址范围是4G，但是对于这4G的逻辑地址，又要划分出来一份给CPU寄存器、ROM的这些物理地址进行映射，那么剩下和内存条的物理地址进行映射的空间肯定没有4G了,如下图所示:
![](logical_physical.png)
其实操作系统显示的内存3.75G，是逻辑地址。
