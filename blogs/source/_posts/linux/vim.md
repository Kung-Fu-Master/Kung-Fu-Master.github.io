---
title: vim
tags:
categories:
- linux
---

================================================================================
对比两个文件不同

	$ vimdiff file1 file2

================================================================================
Linux下复制粘贴快捷键
 1. 在终端下：

          复制命令：Ctrl + Shift + C  组合键.

          粘贴命令：Ctrl + Shift + V  组合键.

 

 2. 在控制台下：

          复制命令：Ctrl + Insert  组合键　　或　　用鼠标选中即是复制。

          粘贴命令：Shift + Insert  组合键　　或　　单击鼠标滚轮即为粘贴。

================================================================================

vi/vim 快速查找单词：

1， 最快的方式是让光标停留在想要查找的单词的任意一个字母上面， 然后输入Shift + *  ，即可快速选中该单词，并且可以通过 n  或  N 进行下一个或上一个的匹配。

2，在一个vim文件中选中单词，另vim文件中查找改单词:
  让光标停留在vim文件中单词的第一个字母上， 然后直接敲击键盘yw两个按键拷贝该单词
  另一个vim或本文件输入 / (Ctrl + R) 0 （即 /”0），回车， 就查找到了第一个匹配的单词， 并且可以  通过n或N进行下一个或上一个的匹配。

================================================================================

vi/vim多行注释和取消注释
多行注释：

1. 进入命令行模式，按ctrl + v进入 visual block模式，然后按j或↓, k或↑选中多行，把需要注释的行标记起来

2. 按大写字母I，再插入注释符，例如//

3. 按（两次）esc键就会全部注释了

取消多行注释：

1. 进入命令行模式，按ctrl + v进入 visual block模式，按字母l(小写"L")或←，→键横向选中列的个数，例如 // 需要选中2列

2. 按字母j，或者k选中注释符号

3. 按d键就可全部取消注释

================================================================================
vim全选，全部复制，全部删除
全选（高亮显示）：按esc后，然后ggvG或者ggVG

全部复制：按esc后，然后ggyG

全部删除：按esc后，然后dG


解析：

gg：是让光标移到首行，在vim才有效，vi中无效 

v ： 是进入Visual(可视）模式 

G ：光标移到最后一行 

选中内容以后就可以其他的操作了，比如： 
d  删除选中内容 
y  复制选中内容到0号寄存器 
"+y  复制选中内容到＋寄存器，也就是系统的剪贴板，供其他程序用 


================================================================================
vi/vim 复制剪切n行


剪切>:
快捷键方式：
dd：剪切光标所处当前行
n + dd：剪切光标所在行及以下共 n 行
按 p 粘贴在光标所在行
命令行方式：
例如剪切1到10行，并粘贴在12行处：
1，10 m 12

复制>：
快捷键方式：
yy：复制光标所处当前行
n + yy：复制光标所在行及以下共 n 行
按 p 粘贴在光标所在行
命令行方式：
例如复制1到10行，并粘贴在12行处：
1，10 co 12

删除>:
快捷键方式：
dd：删除光标所处当前行
n + dd：删除光标所在行及以下共 n 行
命令行方式：
例如删除1到10行：
1，10 de

进入命令行:>
"shift + :" ：进入命令行模式
"set nu"或者"set number" ：显示行号, "set nonu"或者"set nonumber"取消显示行号
"etc + etc" ：退出命令行模式
实际情况下，按 p 粘贴时有的情况是粘贴在光标所在的下一行，自己操作下便可知晓。


================================================================================

vi/vim: 撤销上一次操作:

u   撤销上一步的操作
Ctrl+r 恢复上一步被撤销的操作
注意：
    如果你输入“u”两次，你的文本恢复原样，那应该是你的Vim被配置在Vi兼容模式了。

================================================================================
问题：怎样在vim中实现代码折叠功能？
 
 
解决方法：直接使用vim自带的快捷键和命令，便可以实现功能强大的折叠
 
小试折叠：
1  :set fdm=marker  在vim中执行该命令
2  5G  将光标跳转到第5行
3  zf10G  折叠第5行到第10行的代码，vim会在折叠的开始和结束自动添加三个连续的花括号作为标记
4  zR  打开所有折叠
5  zM  关闭所有折叠
6  zE  删除所有的折叠标签
7  退出vim窗口再次打开，执行2-6步。依然可以折叠，但是没有标记了。重新打开后折叠信息会丢失。
 
折叠方法：
1  manual  （不常用）默认折叠方法，如上面第7步即为该方法，关闭vim折叠会丢失。如果想保持折叠信息，可运行 :mkview 命令，重启后用 :loadview 命令回复。该命令生成的缓存文件位于 ~/.vim/view 文件夹中。移动或重命名文件，折叠信息依然会丢失。
2  indent  （常用）缩进折叠方法，相同的缩进中代码会被折叠。 
3  syntax  （不常用）语法高亮折叠，在c/c++中会折叠花括号部分，其它格式代码中有的不能自动折叠。 
4  marker  （常用）标记折叠方法，如上面1-6所使用的方法。关闭vim折叠信息不会丢失，而且易用控制和标注。
5  还有两种 diff 和 expr，目前我还没有用过。
 
具体介绍：
1  以 marker 为例，可以在vim中运行 :set fdm=marker 来设置折叠方法设置。折叠方法的时候，= 两边不能有空格。也可以将该命令添加到~/.vimrc中，实现vim自动加载。
2  在使用小试折叠中 2 3 步折叠的时候，vim会自动添加三个连续的花括号作为标记，可在开始的花括号前添加介绍，花括号后添加级别号，级别号不能为0。

3  级别的定义稍显复杂。在一般编码中，通常把不需要修改的代码添加标记折叠。没有必要在给折叠分等级。如果想快速折叠就切换为indent折叠方面，适用于任何有缩进的代码。
 
折叠命令：
1  zf  创建折叠，可以按照前面的方式进行折叠，也可以选中代码后进行折叠。 
2  zF  在当前行创建折叠。当一开始就计划要折叠所写代码的时候，可以用该命令创建一对折叠符号，然后再往里面填写内容。
3  :5,10fo  在vim中运行该命令会在折叠 5-10 行中的代码，可以用其它数字代替之。
4  zd  删除光标下的折叠。
5  zD  删除光标下的折叠，以及嵌套的折叠。
6  zE  删除窗口内的所有折叠。仅当 manual 和 marker 折叠方法下有效。
 
打开和关闭折叠：
1  zo  打开光标下的折叠。
2  zO  打开光标下的折叠，以及嵌套的折叠。
3  zc  关闭光标下的折叠。
4  zC  关闭光标下的折叠，以及嵌套的折叠。
5  za  当光标在关闭折叠上时，打开之。在打开折叠上时，关闭之。
6  zA  和za类似，不过对当前折叠和其嵌套折叠都有效。
7  zv  打开当前光标所在折叠，仅打开足够的折叠使光标所在的行不被折叠。
8  zr和zm  一层一层打开折叠和一层一层关闭折叠，这两个命令会递减和递增一个叫foldlevel的变量。如果你发现zm和zr不灵了，那有可能是你连续按的zr或zm次数多了，只要多按几次让foldlevel回到正常状态即可。执行以下zR和zM也可直接让foldlevel回到正常状态。
9  zR和zM  打开所有折叠，设置foldlevel为最高级别。关闭所有折叠，设置foldlevel为0。
 
在折叠间移动：
1  [z  到当前打开折叠的开始。如果已在开始处，移到包含这个折叠的折叠开始处。
2  ]z  到当前打开折叠的结束。如果已在结束处，移到包含这个折叠的折叠结束处。
3  zj  把光标移动到下一个折叠的开始处。
4  zk  把光标移动到前一个折叠的结束处。
 
 
参考：
在vim中运行 :h Folding 命令，查看折叠的帮助文档。



================================================================================

================================================================================
turbostat 由 kernel-tools 数据包提供。
是对 Intel® 64 位处理器中处理器的拓扑、频率、空闲的电源状态统计、温度和用电量的报告。
================================================================================

vim缩进参数解析
缩进用 tab 制表符还是空格，个人爱好问题。但是在大多项目中，习惯使用空格。关于缩进，vim中可以通过如下四个参数进行配置


set tabstop=4
  <--->  set ts=4
set softtabstop=4

set shiftwidth=4

set noexpandtab / expandtab
解析： 

tabstop 
表示按一个tab之后，显示出来的相当于几个空格，默认的是8个。 

softtabstop 
表示在编辑模式的时候按退格键的时候退回缩进的长度。 

shiftwidth 
表示每一级缩进的长度，一般设置成跟 softtabstop 一样 

expandtab与noexpandtab 

当设置成 expandtab 时，缩进用空格来表示，noexpandtab 则是用制表符表示一个缩进。个人习惯使用 ｀set expandtab｀ 

＃标志tab与空格 

在vim中，默认情况下，没法区分空格和缩进，所以我们需要配置，使其能够区分。


================================================================================

vim内容左对齐
:{range}left [margin]
":3,6 left" 命令后，3~6行代码就左对齐，距离边缘0
":3,6 left 4" 命令后，3~6行代码就左对齐，距离边缘4
上面的命令会将代码直接都 “左对齐”了，但代码块并不都是左对齐的啊，所以，还是在命令行模式下，使用 ctrl+v 去选中代码块，按下=号，从而让代码块对齐比较好用。

方法一:

命令模式下：=:1,$

方法二：
gg（把关标定位到最上面），V（进入VISUAL模式），shift+g（选中整篇文本），然后＝。

方法三：
gg=G

================================================================================

查看某个函数定义
shift + k

水平分屏：
：sp		水平分屏打开当前文件
：sp filename	水平分屏打开另一个文件
vim -o exe18.c Makefile hello.c		默认打开3个文件并将它们水平分屏
vim -o3 exe18.c Makefile hello.c	打开3个文件并将它们水平分屏
vim -on ... (n可以省略，表示分屏的个数)

vim -o *.c 垂直打开所有.c文件

垂直分屏
：vsp		垂直分屏打开当前文件
：vsp filename	垂直分屏打开另一个文件
vim -O exe18.c Makefile hello.c		默认打开3个文件并将它们垂直分屏
vim -O3 exe18.c Makefile hello.c	打开3个文件并将它们垂直分屏
     ↓
   （大写o）

切换屏幕
ctrl+两次w，或者ctrl + ←||→ 切换屏幕

退出屏幕
:q 	退出当前光标在的屏幕
：qall	退出所有屏幕

保存
：w	保存当前屏幕
：wall	保存所有打开的屏幕
：wqall	保存退出所有打开的屏幕

为了让鼠标可以在几个屏幕间自由切换。
按："Esc"键 + “：”，输入：set mouse=a 。然后，回车(Enter)，这样鼠标就可以在多屏幕之间自由移动了，但是不能复制vim内容
：set mouse=v，即可选中复制内容到粘贴板
================================================================================

显示所打开的文件名
1、:set laststatus=2
:file或:f

2、CTRL+g

3、在/etc/vim/vimrc中添加
set statusline=%F\ [%{&fenc}\ %{&ff}\ L%l/%L\ C%c]\ %=%{strftime('%Y-%m-%d\ %H:%M')}
set laststatus=2

================================================================================

#vim里面有个快捷键可以用来补全代码 C-n  （Ctrl+n）
  需要先有头文件，如vim中输入str后，按ctrl+n不会显示strlen()函数，只有在vim中添加
  #include<string.h>头文件后才会智能提示strlen()函数

”Ctrl + }“ 可以跳转到函数或变量的定义处，“Ctrl + o”可以返回上一个跳转页面。

================================================================================

比较两个文件file1和file2
vim file1 file2 -O
	-o(小写)水平打开两个文件
	-O(大写)垂直打开两个文件

================================================================================
4294967295000 / (1000 * 1000) = 4294967.295

================================================================================
垂直分屏
：vsp filename	垂直分屏打开另一个文件
为了让鼠标可以在几个屏幕间自由切换。
按："Esc"键 + “：”，输入：set mouse=a 。然后，回车(Enter)，这样鼠标就可以在多屏幕之间自由移动了。

================================================================================
The ycmd server SHUT DOWN (restart with ':YcmRestartServer'). 
Unexpect ...ype ':YcmToggleLogs ycmd_*.log' to check the logs
:YcmToggleLogs ycmd_37783_stderr_zcxys8hw.log
	ImprotError: Python version mismatch:module was compiled for Python 3.6, 
	but the interpreter version is incompatible:3.5.2(default), Nov 12 2018, 13:43:14
:YcmToggleLogs ycmd_44993_stderr_uid3uor7.log
:YcmToggleLogs ycmd_49853_stderr_yckx0mks.log

================================================================================
Vim如何跳转到光标的上次位置
Ctrl + O
Ctrl + I
装了Ctag的插件可以跳转 Ctrl+】。查看函数调用。 
================================================================================

vim复制代码包含注释格式如"//"会乱掉
	乱码问题
	一般来说只需要正确设置vim的编码识别序列就很少会遇到乱码问题：
	set fileencodings=ucs-bom,utf-8,utf-16,gbk,big5,gb18030,latin1

	1. 每次复制代码时，如果代码里有 // 这样的注释就容易让格式乱掉，通过下面的设置就可以避免这种情况。  
	2.   
	3. 粘贴代码时取消自动缩进  
	4. VIM在粘贴代码时会自动缩进，把代码搞得一团糟糕，甚至可能因为某行的一个注释造成后面的代码全部被注释掉，我知道有同学这个时候会用vi去打开文件再粘贴上去（鄙人以前就是这样），其实需要先设置一下  
	5. set paste  
	6. 然后再进入插入模式粘贴，代码就不会被自动缩进。可是敲代码的时候需要自动缩进，又得改回来:  
	7. set nopaste  
	8. 最方便的方法就是在.vimrc中加一句：  
	9. set pastetoggle=<F9>  
	10. 以后在插入模式下，只要按F9键就可以切换自动缩进。

From <https://www.iteye.com/blog/haoningabc-1907479> 



================================================================================

