<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.1" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.1" type="image/png" sizes="32x32"><meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://kung-fu-master.github.io/page/27/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Kung-Fu-Master">
<meta name="twitter:card" content="summary"><title>Hexo</title><link ref="canonical" href="https://kung-fu-master.github.io/page/27/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.1"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":false,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: true,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 4.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return false;"><span class="header-nav-menu-item__icon"><i class="fas fa-feather-alt"></i></span><span class="header-nav-menu-item__text">文章</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/"><span class="header-nav-submenu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-submenu-item__text">分类</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/archives/"><span class="header-nav-submenu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-submenu-item__text">归档</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/tags/"><span class="header-nav-submenu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-submenu-item__text">标签</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-fingerprint"></i></span><span class="header-nav-menu-item__text">关于</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">搜索</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hexo</div><div class="header-banner-info__subtitle"></div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E9%94%99%E8%AF%AF_r_command%20not%20found/">脚本执行错误 $'\r':command not found</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">221</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>shell脚本执行错误 $’\r’:command not found<br>第一种解决方案：<br>Linux下有命令dos2unix<br>你只要输入dos2unix *.sh就可以完成转换工作了<br>如果命令不存在的话就用如下命令安装<br>yum install dos2unix -y</p>
<p>第二种解决方案：<br>这种情况发生的原因是因为你所处理的文件换行符是dos格式的”\r\n”<br>可以使用cat -v 文件名 来查看换行符是否是，如果是上述的，则行结尾会是^m<br>需要转换成linux/unix格式的”\n<br>sed ‘s/\r//‘ 原文件 &gt;转换后文件<br>第三种解决方案：<br>首先要确保文件有可执行权限<br>#sh&gt;chmod a+x filename<br>利用如下命令查看文件格式<br>:set ff 或 :set fileformat<br>可以看到如下信息<br>fileformat=dos 或 fileformat=unix<br>利用如下命令修改文件格式<br>:set ff=unix 或 :set fileformat=unix</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/%E8%BF%9E%E6%8E%A5router%E5%90%8E%E6%9C%BA%E5%99%A8%E8%BF%9E%E4%B8%8D%E4%B8%8A%E5%A4%96%E7%BD%91/">连接router后机器连不上外网</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">584</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>几台机器连接同一个路由器router后，centos机器连不上外网<br>[root@sphm001 ~]# route -n<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br>0.0.0.0         192.168.1.1    0.0.0.0         UG    100    0        0 enp0s31f6<br>0.0.0.0         10.239.173.1    0.0.0.0         UG    101    0        0 enp0s20f0u8<br>10.239.173.0    0.0.0.0         255.255.255.0   U     101    0        0 enp0s20f0u8<br>192.168.1.0     0.0.0.0         255.255.255.0   U     100    0        0 enp0s31f6<br>[root@sphm001 ~]#<br>[root@sphm001 ~]# route del -net 0.0.0.0 gw 192.168.1.1<br>[root@sphm001 ~]# route -n<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br>0.0.0.0         10.239.173.1    0.0.0.0         UG    101    0        0 enp0s20f0u8<br>10.239.173.0    0.0.0.0         255.255.255.0   U     101    0        0 enp0s20f0u8<br>192.168.1.0     0.0.0.0         255.255.255.0   U     100    0        0 enp0s31f6<br>[root@sphm001 ~]#<br>[root@sphm001 ~]# wget <span class="exturl"><a class="exturl__link"   href="http://www.baidu.com"  target="_blank" rel="noopener">www.baidu.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>–1998-01-29 23:28:17–  <span class="exturl"><a class="exturl__link"   href="http://www.baidu.com/"  target="_blank" rel="noopener">http://www.baidu.com/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>Resolving child-prc.intel.com (child-prc.intel.com)… 10.239.4.101<br>Connecting to child-prc.intel.com (child-prc.intel.com)|10.239.4.101|:913… connected.<br>Proxy request sent, awaiting response… 200 OK<br>Length: 2381 (2.3K) [text/html]<br>Saving to: ‘index.html.1’</p>
<p>100%[============================================================================================&gt;] 2,381       –.-K/s   in 0s</p>
<p>1998-01-29 23:28:17 (81.6 MB/s) - ‘index.html.1’ saved [2381/2381]<br>修改完路由如果还不行就重启机器试试<br>[root@sphm001 ~]#</p>
<p>linux上用route添加/删除路由</p>
<ol>
<li>查看<br>route -n<ol start="2">
<li>添加<br>route add -net 9.123.0.0 netmask 255.255.0.0 gw 9.123.0.1</li>
<li>删除<br>route del -net 9.123.0.0 netmask 255.255.0.0 gw 9.123.0.1</li>
</ol>
</li>
</ol>
<p>有些童鞋问怎么加永久路由，很简单，把 “route add -net 9.123.0.0 netmask 255.255.0.0 gw 9.123.0.1” 写到/etc/rc.local最后就行了，<br>或者复制编辑好执行也可以：<br>echo “route add -net 9.123.0.0 netmask 255.255.0.0 gw 9.123.0.1” &gt;&gt; /etc/rc.local</p>
<p>实际中发现，CentOS7.4默认环境下，rc.local中不会执行，需要赋权才可以<br>chmod +x /etc/rc.local</p>
<p>From <span class="exturl"><a class="exturl__link"   href="https://www.cnblogs.com/lynsen/p/8027446.html"  target="_blank" rel="noopener">https://www.cnblogs.com/lynsen/p/8027446.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> </p>
<figure class="highlight haml"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~~</span><br></pre></td></tr></table></div></figure>
<pre><code>SPH + RVP
root@imie:~# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.239.173.1    0.0.0.0         UG    0      0        0 eth1
10.239.173.0    0.0.0.0         255.255.255.0   U     0      0        0 eth1
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 eth0
root@imie:~#


root@imie:~# vim /etc/network/interfaces
iface lo inet loopback

# Wired interfaces
auto eth0 eth1
iface eth0 inet dhcp
iface eth1 inet dhcp

# iface eth0 inet manual
# iface eth1 inet manual

# Network bridge
# auto br0
# iface br0 inet dhcp
#   bridge_ports eth0 eth1</code></pre></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/micro_service/istio/01_istio_kubernetes%E7%BD%91%E4%B8%8A%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90/">istio kubernetes网上学习资源</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">122</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="网上提供的master和work机器"   >
          <a href="#网上提供的master和work机器" class="heading-link"><i class="fas fa-link"></i></a>网上提供的master和work机器</h2>
      <p>katacoda:<br><span class="exturl"><a class="exturl__link"   href="https://katacoda.com/courses/kubernetes/playground"  target="_blank" rel="noopener">https://katacoda.com/courses/kubernetes/playground</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br><span class="exturl"><a class="exturl__link"   href="https://www.katacoda.com/courses/istio/deploy-istio-on-kubernetes"  target="_blank" rel="noopener">https://www.katacoda.com/courses/istio/deploy-istio-on-kubernetes</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>play-with-k8s:<br><span class="exturl"><a class="exturl__link"   href="https://labs.play-with-k8s.com/"  target="_blank" rel="noopener">https://labs.play-with-k8s.com/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="redhat官网提供的istio学习教程"   >
          <a href="#redhat官网提供的istio学习教程" class="heading-link"><i class="fas fa-link"></i></a>redhat官网提供的istio学习教程</h2>
      <p><span class="exturl"><a class="exturl__link"   href="http://developers.redhat.com/topics/service-mesh/"  target="_blank" rel="noopener">http://developers.redhat.com/topics/service-mesh/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="IBM的Istio示例教程"   >
          <a href="#IBM的Istio示例教程" class="heading-link"><i class="fas fa-link"></i></a>IBM的Istio示例教程</h2>
      <p><span class="exturl"><a class="exturl__link"   href="https://developer.ibm.com/code/patterns/manage-microservices-traffic-using-istio"  target="_blank" rel="noopener">https://developer.ibm.com/code/patterns/manage-microservices-traffic-using-istio</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="bilibili一些教程视频"   >
          <a href="#bilibili一些教程视频" class="heading-link"><i class="fas fa-link"></i></a>bilibili一些教程视频</h2>
      <p>[Done]<span class="exturl"><a class="exturl__link"   href="https://www.bilibili.com/video/BV1Xz411b79q?p=7"  target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Xz411b79q?p=7</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="其它网站教程"   >
          <a href="#其它网站教程" class="heading-link"><i class="fas fa-link"></i></a>其它网站教程</h2>
      <p>Service Mesh实战<br><span class="exturl"><a class="exturl__link"   href="https://time.geekbang.org/course/intro/303?utm_term=zeusL6Y5E&amp;utm_source=bilibili&amp;utm_medium=geektime&amp;utm_content=pinglun"  target="_blank" rel="noopener">https://time.geekbang.org/course/intro/303?utm_term=zeusL6Y5E&amp;utm_source=bilibili&amp;utm_medium=geektime&amp;utm_content=pinglun</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>相应gihub资料: <span class="exturl"><a class="exturl__link"   href="https://github.com/geektime-geekbang/geektime-servicemesh"  target="_blank" rel="noopener">https://github.com/geektime-geekbang/geektime-servicemesh</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/wget_www.baidu.com/">wget www.baidu.com</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">21</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>Ping <span class="exturl"><a class="exturl__link"   href="http://www.baidu.com"  target="_blank" rel="noopener">www.baidu.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 改为 ：wget <span class="exturl"><a class="exturl__link"   href="http://www.baidu.com"  target="_blank" rel="noopener">www.baidu.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 来测试是否机器可以上网</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/yum%E4%B8%8B%E8%BD%BD%E9%81%87%E5%88%B0XZ_5.1.2alpha%E9%97%AE%E9%A2%98/">yum下载遇到XZ_5.1.2alpha问题</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">439</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>遇到如下问题：<br>[root@localhost download]# yum -y install libopencv-dev<br>There was a problem importing one of the Python modules<br>required to run yum. The error leading to this problem was:</p>
<p>   /lib64/liblzma.so.5: version `XZ_5.1.2alpha’ not found (required by /lib64/librpmio.so.3)</p>
<p>Please install a package which provides this module, or<br>verify that the module is installed correctly.</p>
<p>It’s possible that the above module doesn’t match the<br>current version of Python, which is:<br>2.7.5 (default, Jun 20 2019, 20:27:34)<br>[GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]</p>
<p>If you cannot solve this problem yourself, please go to<br>the yum faq at:<br>  <span class="exturl"><a class="exturl__link"   href="http://yum.baseurl.org/wiki/Faq"  target="_blank" rel="noopener">http://yum.baseurl.org/wiki/Faq</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>[root@localhost download]#<br>…</p>
<p>解决方法：</p>
<p> /lib64/liblzma.so.5: version `XZ_5.1.2alpha’ not found (required by /lib64/librpmio.so.3)<br>    1. 下载安装 xz-5.2.2.tar.gz<br>        进入xz工具官网下载源码包：<span class="exturl"><a class="exturl__link"   href="http://tukaani.org/xz/"  target="_blank" rel="noopener">http://tukaani.org/xz/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>              下载版本：xz-5.2.2.tar.gz<br>    a. 下载之后，将压缩包解压 tar -vxf xz-5.2.2.tar.gz</p>
<pre><code>      b. 进入到xz源码目录 cd  xz-5.2.2.tar.gz

      c. 配置 ./configure--enable-shared

      d. 编译 make

      e. 安装 makeinstall

   如此，则系统安装了xz工具。
   当然，如果用户自己希望安装到自己的特定路径下，可以在配置选项中，设定安装路径，如
     ./configure --enable-shared --prefix=/opt/install/xz/bin

     这样xz工具就被安装在/tmp/xz目录中，如果要导入到系统，则需要设置环境变量，编辑系统配置文件,

     vi  /etc/bash.bashrc

     在系统配置文件的末尾，加入路径：

     export PATH=$PATH:/opt/install/xz/bin

     export PATH

     如果修改了环境变量，需要 

      4.3 验证是否xz安装成功

      在终端中，输入命令查看版本号：   xz -V
      得到信息如下，则说明安装成功。
      xz (XZ Utils) 5.2.2
      liblzma 5.2.2

2. 到/lib64/目录
cp /lib64/liblzma.so.5.2.2 .
sudo ln -s -f liblzma.so.5.2.2 liblzma.so.5
就可以了</code></pre></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/yum%E4%BD%BF%E7%94%A8%E5%92%8C%E5%AE%89%E8%A3%85cmake-3%E7%89%88%E6%9C%AC%E4%B8%8A/">yum使用和安装cmake 3 版本上</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">396</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>第一种安装cmake3<br>$yum search cmake<br>    ……<br>    cmake3.x86_64 : Cross-platform make system<br>    ……</p>
<p>$yum install cmake3.x86_64<br>    //但使用命令需用cmake3</p>
<p>$cmake3 –version      //查看cmake版本</p>
<p>$yum remove cmake3</p>
<p>第二种:<br>（1）移除旧版本：<br>yum remove cmake<br>（2）下载新版本<br>1、下载：wget <span class="exturl"><a class="exturl__link"   href="https://cmake.org/files/v3.6/cmake-3.6.0-Linux-x86_64.tar.gz"  target="_blank" rel="noopener">https://cmake.org/files/v3.6/cmake-3.6.0-Linux-x86_64.tar.gz</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>2、解压：tar -zxvf cmake-3.6.0-Linux-x86_64.tar.gz<br>注意：这个压缩包不是源码包，解压后直接用。<br>3、增加环境变量，使其成为全局变量：<br>vim /etc/profile  // 或者vim ~/.bashrc<br>在文件末尾处增加以下代码<br>export PATH=$PATH:/lnmp/src/cmake-3.6.0-Linux-x86_64/bin<br>注意：写自己刚安装cmake的bin的路径<br>使修改的文件生效<br>source /etc/profile //或者 source ~/.bashrc<br>4、查看环境变量：<br>echo $PATH<br>5、检查cmake版本：<br>cmake –version</p>
<p> 扩展知识：<br>百度百科的介绍：<br>CMake是一个跨平台的安装（编译）工具，可以用简单的语句来描述所有平台的安装(编译过程)。<br>他能够输出各种各样的makefile或者project文件，能测试编译器所支持的C++特性,类似UNIX下的automake。<br>只是 CMake 的组态档取名为 CMakeLists.txt。Cmake 并不直接建构出最终的软件，而是产生标准的建构档<br>（如 Unix 的 Makefile 或 Windows Visual C++ 的 projects/workspaces），然后再依一般的建构方式使用。<br>这使得熟悉某个集成开发环境（IDE）的开发者可以用标准的方式建构他的软件，这种可以使用各平台的原生<br>建构系统的能力是 CMake 和 SCons 等其他类似系统的区别之处。</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/yum%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">yum 遇到的问题</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">150</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="安装python3后用yum安装软件出错"   >
          <a href="#安装python3后用yum安装软件出错" class="heading-link"><i class="fas fa-link"></i></a>安装python3后用yum安装软件出错</h2>
      <p><code>yum search</code> 出现错误1：except KeyboardInterrupt, e:<br><code>yum install</code> 出现错误2： except OSError, e:</p>

        <h3 id="第一种：升级yum"   >
          <a href="#第一种：升级yum" class="heading-link"><i class="fas fa-link"></i></a>第一种：升级yum</h3>
      
        <h3 id="第二种-修改文件里的python为python2"   >
          <a href="#第二种-修改文件里的python为python2" class="heading-link"><i class="fas fa-link"></i></a>第二种: 修改文件里的python为python2</h3>
      <p>CentOS系统原带有Python2，后自行安装Python3，并改变/usr/bin/python连接到python3，在执行python的时候直接调用python3.5版本。<br>原因是 <code>yum does not support Python3</code>, 该改变导致了yum运行时会报错。<br>解决方法修改/usr/bin下的yum文件的第一行：  </p>
<pre><code>$ vim /usr/bin/yum
  1 #!/usr/bin/python --&gt;&gt; #!/usr/bin/python2.7

$ vim /usr/libexec/urlgrabber-ext-down
  1 #! /usr/bin/python2  --&gt;&gt;  #!/usr/bin/python2.7</code></pre></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/%E4%BF%AE%E6%94%B9os%E6%97%B6%E9%97%B4%E6%97%B6%E5%8C%BA/">linux 修改系统时间时区</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">108</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>发现一台服务器时间比北京时间慢 12 个小时，使用 date 命令后发现是：</p>
<pre><code>2019年 06月 04日 星期二 21:50:33 EDT</code></pre><p>EDT 时间即美国东部时间。这里要改为北京时间即可：</p>
<pre><code>mv /etc/localtime /etc/localtime.bak
ln -s /usr/share/zoneinfo/Asia/Shanghai  /etc/localtime</code></pre><p>然后再次 date 查看日期：</p>
<pre><code>2019年 06月 05日 星期三 11:10:58 CST</code></pre><p>时间就变成北京时间了.</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/%E6%8C%89%E5%AD%97%E8%8A%82-%E5%AD%97%E5%AF%BB%E5%9D%80_%E5%AD%97%E9%95%BF_%E5%9C%B0%E5%9D%80%E6%80%BB%E7%BA%BF_%E6%95%B0%E6%8D%AE%E6%80%BB%E7%BA%BF%E5%85%B3%E7%B3%BB/">按字节/字寻址，字长，地址总线，数据总线关系</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">1k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>设一个1MB容量的存储器，字长为32位，问：</p>
<p>1）按字节编址，地址寄存器和数据寄存器个几位？</p>
<p>2）按字编址，地址寄存器和数据寄存器个几位？</p>
<p>答案是：<br>1）1MB=2^20×8 位，地址寄存器为20位，数据寄存器为8位</p>
<p>2）1MB=2^18×32 位，地址寄存器为18位，数据寄存器为32位</p>
<p>我的理解：<br>字长是CPU一次处理数据也就是读取和写数据的长度(等于数据总线)，与按字编址(每个存储单元长度bit)是不同的概念<br>按字节编址(寻址)每个存储单元8bit<br>按字编址(32bit)每个存储单元32bit</p>
<pre><code>1. 按字节编址，字长需要出题人根据心情随意给出比如16位，则CPU一次读写32bit的数据，存储容量1MB
    存储容量1MB = 2^20*8bit = 2^19*16bit, 则地址总线19根，数据总线16根
    也就是地址寄存器19位，数据寄存器16位
2. 按字节编址(8bit)，字长32bit
    CPU一次读写4个内存地址空间数据
3. 按字编址(32bit)，字长32bit
    CPU一次读写1个内存地址空间数据</code></pre><p>CPU的地址总线是由其通用寄存器的地址总线决定<br>我们生活中的笔记本电脑一般CPU通用寄存器的地址总线和数据总线都为32bit<br>因为我们笔记本电脑内存4GB，字长32bit，一般(如果不指明默认情况下)都是按字节编址(寻址)<br>    1. 字长32bit因此确定数据总线为32根<br>    2. 4GB = 2^32*8bit, 因此地址总线32根</p>
<p>如下图:<br>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="address.png"  alt="">
      </p>
<p>地址00h直接跳到04h, 后缀h,前缀0x代表16进制，每一行32bit，说明：<br>    1. 字长32bit<br>    2. 按字节寻址<br>    因此CPU一次处理读写4个地址空间数据如地址00h~03h</p>
<p>32位的处理器(CPU)强调的是数据总线的宽度，32位操作系统强调的是地址总线的宽度, 然后默认按字节寻址(8bit)则只能支持4GB大小内存, 地址总线确定最大可寻址内存范围.</p>
<p>32位cpu，应该说清楚是cpu的地址总线位宽为32位的时候最大只能支持4G的寻址，所以只能支持4G。 如果这里的32位CPU指的是数据总线位宽就不能说明最大可以使用4G内存。 另外，还受制于操作系统的位数，如果操作系统是32位就意味着逻辑地址寻址范围在4G以内，这样就算是64位地址总线也无法使用4G以上的内存空间。</p>
<p>百度百科里32位处理器和32位操作系统都和4G内存扯上了关系。说明32位处理器的地址总线宽度是32位，32位操作系统的地址总线宽度也是32位。</p>
<p>CPU在执行指令时需要先将指令的逻辑地址变换为物理地址才能执行。<br>    地址总线数目    最大支持内存<br>32位系统    32    2的32次方 = 4G<br>64位系统    36或40    2的36次方 = 64G 或 2的40次方= 1024G = 1T</p>
<p>问题：<br>• 自己装的是4G内存条，可是操作系统显示的内存却是3.75G<br>• 自己装的是8G内存条，可是操作系统显示的内存也是3.75G<br>在使用计算机时，其支持的最大内存是由操作系统和硬件两方面决定的。<br>实际上用户在使用计算机时，进程访问到的地址都是逻辑地址，并不是真实的物理地址，逻辑地址是由操作系统提供的，并维护了逻辑地址和物理地址的映射<br>对于32位的windows操作系统，提供的逻辑地址寻址范围是4G，但是对于这4G的逻辑地址，又要划分出来一份给CPU寄存器、ROM的这些物理地址进行映射，那么剩下和内存条的物理地址进行映射的空间肯定没有4G了,如下图所示:<br>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="logical_physical.png"  alt="">
      <br>其实操作系统显示的内存3.75G，是逻辑地址。</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/13/linux/sda_hda/">sda hda</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-03-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">697</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="sda-hda"   >
          <a href="#sda-hda" class="heading-link"><i class="fas fa-link"></i></a>sda,hda</h2>
      <p>hda一般是指IDE接口的硬盘，hda一般指第一块硬盘，类似的有hdb,hdc等<br>sda一般是指SATA接口的硬盘，sda一般指第一块硬盘，类似的有sdb,sdc等</p>
<p>现在的内核都会把硬盘，移动硬盘，U盘之类的识别为sdX的形式。</p>
<p>SATA接口是串行数据接口，俗称串口。在硬盘外部传输速度目前最快可达250M/S 。<br>IDE接口是并行数据接口，俗称并口，在硬盘外部传输速度最快可达133M/S。<br>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="sda_interface.png"  alt="sda接口">
      </p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="IDE_interface.png"  alt="IDE接口">
       
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="power_data_interface.png"  alt="">
      </p>
<p>IDE转SATA线如下，先把IDE一头接入到硬盘上，然后电源跟电脑电源线相连，然后把SATA则接入主板上面</p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="IDE_power_sata.png"  alt="ide接口">
      <br>IDE是英文IntegratedDriveElectronics的缩写，翻译成中文叫做“集成驱动器电子”，<br>IDE接口即指并行IDE接口（PATA接口），使用并行接口的硬盘既称为并口硬盘，IDE是一种较老的技术，在几年前很常见，目前在在硬盘方面基本不再使用此接口，其接口连接比较简单，只需用一根40线电缆将它们与主板或接口卡连起来就可以了。<br>sata接口<br>SATA接口（SerialATA）又称为串行ATA，是一种接口技术，使用SATA接口的<br>硬盘又叫串口硬盘，其最终将取代使用IDE接口的并口硬盘！SATA接口的历史：2001年，由Intel、APT、Dell、IBM、希捷、迈拓这几大厂商</p>
<p>ide接口与sata接口的区别是什么</p>
<figure class="highlight angelscript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、SATA硬盘比IDE硬盘传输速度高。目前SATA可以提供<span class="number">150</span>MB/s的高峰传输速率。今后将达到<span class="number">300</span> MB/s和<span class="number">600</span> MB/s。到时我们将得到比IDE硬盘快近<span class="number">10</span>倍的传输速率。</span><br><span class="line"><span class="number">2</span>、 相对于IDE硬盘的PATA40针的数据线，SATA的线缆少而细，传输距离远，可延伸至<span class="number">1</span>米，使得安装设备和机内布线更加容易。连接器的体积小，这种线缆有效的改进了计算机内部的空气流动，也改善了机箱内的散热。</span><br><span class="line"><span class="number">3</span>、相对于IDE硬盘系统功耗有所减少。SATA硬盘使用<span class="number">500</span>毫伏的电压就可以工作。</span><br><span class="line"><span class="number">4</span>、SATA可以通过使用多用途的芯片组或串行——并行转换器来向后兼容PATA设备。由于SATA和PATA可使用同样的驱动器，不需要对操作系统进行升级或其他改变。</span><br><span class="line"><span class="number">5</span>、SATA不需要设置主从盘跳线。BIOS会为它按照<span class="number">1</span>、<span class="number">2</span>、<span class="number">3</span>顺序编号。这取决于驱动器接在哪个SATA连接器上（安装方便）。而IDE硬盘需要设置通过跳线来设置主从盘。</span><br><span class="line"><span class="number">6</span>、SATA还支持热插拔，可以象U盘一样使用。而IDE硬盘不支持热插拔.</span><br></pre></td></tr></table></div></figure>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><a class="extend prev" rel="prev" href="/page/26/"><i class="fas fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><span class="page-number current">27</span><a class="page-number" href="/page/28/">28</a><span class="space">&hellip;</span><a class="page-number" href="/page/30/">30</a><a class="extend next" rel="next" href="/page/28/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">Kung-Fu-Master</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://plus.google.com/" target="_blank" rel="noopener" data-popover="Google" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-google"></i></span></a><a class="sidebar-ov-social-item" href="https://twitter.com/" target="_blank" rel="noopener" data-popover="Twitter" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-twitter"></i></span></a><a class="sidebar-ov-social-item" href="https://youtube.com/" target="_blank" rel="noopener" data-popover="Youtube" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-youtube"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">291</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">40</div><div class="sidebar-ov-state-item__name">分类</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">12</div><div class="sidebar-ov-state-item__name">标签</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2021</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Kung-Fu-Master</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 强力驱动</span><span> v4.2.0</span><span class="footer__devider">|</span><span>主题 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.1</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="搜索文章（支持多关键词，请用空格分隔）"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.min.js"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // 将 XML 转为 JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // 搜索对象（标题、内容）的权重，影响显示顺序
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // 根据空白字符分隔关键字
        var keywords = searchText.split(/[\s]+/);
        // 搜索结果
        var matchPosts = [];

        // 有多个关键字时，将原文字整个保存下来
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // 防止未输入字符时搜索
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // 没有标题的文章使用预设的 i18n 变量代替
            var title = (data.title && data.title.trim()) || '[ 文章无标题 ]';
            var titleLower = title && title.toLowerCase();
            // 删除 HTML 标签 和 所有空白字符
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // 删除重复的 /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // 标题中匹配到的关键词
            var titleHitSlice = [];
            // 内容中匹配到的关键词
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * 获取匹配的关键词的索引
              * @param {String} keyword 要匹配的关键字
              * @param {String} text 原文字
              * @param {Boolean} caseSensitive 是否区分大小写
              * @param {Number} weight 匹配对象的权重。权重大的优先显示
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // 每次匹配的开始索引
                var index = -1;     // 匹配到的索引值
                var result = [];    // 匹配结果

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // 索引位置相同的关键词，保留长度较长的
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // 按照匹配文字的索引的递增顺序排序
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * 给文本中匹配到的关键词添加标记，从而进行高亮显示
              * @param {String} text 原文本
              * @param {Array} hitSlice 匹配项的索引信息
              * @param {Number} start 开始索引
              * @param {Number} end 结束索引
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // 文章总的搜索权重
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // 标记匹配关键词后的标题
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // 标记匹配关键词后的内容
              var postContent;
              // 显示内容的长度
              var SHOW_WORD_LENGTH = 200;
              // 命中关键词前的字符显示长度
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // 截取匹配的第一个字符，前后共 200 个字符来显示
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // 未匹配到内容，直接截取前 200 个字符来显示
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // 按权重递增的顺序排序，使权重大的优先显示
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', '请输入字符');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="/js/utils.js?v=2.6.1"></script><script src="/js/stun-boot.js?v=2.6.1"></script><script src="/js/scroll.js?v=2.6.1"></script><script src="/js/header.js?v=2.6.1"></script><script src="/js/sidebar.js?v=2.6.1"></script><script type="application/json" src="/search.json"></script></body></html>