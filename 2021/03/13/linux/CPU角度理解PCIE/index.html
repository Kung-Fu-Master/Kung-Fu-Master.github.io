<!-- build time:Sat Jun 26 2021 21:40:59 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Hexo" href="https://kung-fu-master.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Hexo" href="https://kung-fu-master.github.io/atom.xml"><link rel="alternate" type="application/json" title="Hexo" href="https://kung-fu-master.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://kung-fu-master.github.io/2021/03/13/linux/CPU%E8%A7%92%E5%BA%A6%E7%90%86%E8%A7%A3PCIE/"><title>CPU角度理解PCIE - linux | Kung Fu Master = Hexo</title><meta name="generator" content="Hexo 4.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">CPU角度理解PCIE</h1><div class="meta"><span class="item" title="创建时间：2021-03-13 12:35:14"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-03-13T12:35:14+08:00">2021-03-13</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>6.9k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>6 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Kung Fu Master</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclize41wj20zk0m87gk.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicliierfjj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclxp31goj20zk0m8qv5.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giph4wqtg4j20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicitspjpbj20zk0m81ky.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/linux/" itemprop="item" rel="index" title="分类于 linux"><span itemprop="name">linux</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://kung-fu-master.github.io/2021/03/13/linux/CPU%E8%A7%92%E5%BA%A6%E7%90%86%E8%A7%A3PCIE/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Kung-Fu-Master"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Hexo"></span><div class="body md" itemprop="articleBody"><p>概述<br>为什么需要写这篇文章，当我阅读《深入浅出 SSD》这篇书籍中 PCIe 章节时发现，本书籍的侧重点是放在 PCIe 控制器和 PCIe 协议上，从 CPU 角度理解 PCIe 知识偏少，本文对下面几个知识点做出一些补充。</p><p>CPU 访问外设寄存器与内存编址方式；<br>CPU 如何访问 PCIe 配置空间；<br>CPU 能够通过寄存器访问配置空间，为什么还需要映射 PCIe 配置空间；<br>如何扫描 PCIe 树并且为 PCIe 分配 ID；<br>如何将 pcie 域地址映射到存储器域地址空间。<br>通过本篇文章将对问题 1、2、3 做出解答。</p><p>统一编址于独立编址<br>CPU 编址是程序指令与物理地址线建立链接的方式，在 CPU 内部有专门的地址集合，编址过程是由 CPU 体系架构所决定的，参考示意图如图 1 所示（仅仅代表示意图，讲解一种逻辑结构，不代表实际电路）。CPU 编址时就已经指定了 0x8000_0000~0xFFFF_FFFF 这个地址空间为连接到图中内存的地址线，内存如何连接到 CPU 需要当参考 CPU 的 datasheet，当 CPU 程序指令对 0x8000_0000 这个物理地址地址发起访问时，等价于是在访问图中 2G 内存的首地址。<br><img data-src="picture1.jpg" alt=""><br>图 1</p><p>内存通过 CPU 地址总线来寻址定位，然后通过 CPU 数据总线读写数据。CPU 的地址总线位数是 CPU 设计时确定，因此一款 CPU 所能寻址的地址范围是一定的，而内存是需要占用 CPU 的寻址空间的，内存与 CPU 采用总线直接连接。</p><p>IO 指的是与 CPU 连接的各种外设，CPU 访问各种外设有两种方式：一种是类似于访问内存的方式，即把外设的寄存器当成内存地址读写，从文可以以访问内存方式操作外设寄存器。这时，IO 与内存统一编址，IO 地址与内存地址在同一个地址空间下，这种编址方式叫做 IO 与内存统一编址。另外一种编址方式是 IO 地址与内存地址分开独立编址，这种编址方式叫做独立编址，此时，CPU 访问外设寄存器需要通过 CPU 特定的指令去访问外设寄存器，而不能通过地址直接访问外设寄存器。常见的 ARM、PowerPc、MIPS 架构都是采用统一编址，X86 架构采用独立编址。</p><p>访问 PCIe 配置空间 256bytes<br>PCI 总线规定访问配置空间总线事务，使用 ID 号进行寻址。PCI 设备 ID 号由总线号（Bus Number）、设备号（Device Number）和功能号（Function Number）。其中总线号在 HOST 主桥遍历 PCI 总线树时确定，在一颗 PCI 总线树上，总线号由系统软件决定，通常与 HOST 主桥直接相连接的 PCI 总线编号为 0，系统软件使用 DFS（Depth-First Search）算法扫描 PCI 总线树上的所有 PCI 总线，并依次编号。一条 PCI 总线的设备号由 PCI 设备的 IDSEL 信号与 PCI 总线地址线的连接关系确定，功能号与 PCI 设备的具体设计有关。一个 PCIe 系统最多有 256 条 Bus，每条 Bus 上最多可以挂在 32 个设备，每个 PCIe 设备最多有 8 个功能设备。</p><p>在 XX 处理器中的 HOST 主桥中，与 PCIE 设备配置相关的寄存器由 CFG_ADDR、CFG_DATA 等组成。系统软件使用 CFG_ADDR（CFG_ADDR 寄存器结构如图 2 所示）和 CFG_DATA 寄存器访问 PCIe 设备的配置空间，这些寄存器都是采取同一编址（所有内存寄存器都使用存储器映射方式进行寻址）。当处理器访问 PCIe 配置空间时，首先需要在 CFG_ADD 寄存器中设置这个 PCIe 设备对应的总线号、设备号、功能号和寄存器偏移，然后使能 Enable 位，之后当处理器对 CFG_DATA 读写访问时，HOST 主桥将这个存储器读写访问转换成 PCIe 配置读写请求，并且发送到 PCIe 总线上。如果 Enable 位没有使能，那么 CPU 对寄存器的访问也就是一个普通 IO 的访问，而不能让 HOST 转换成总线请求访问，访问 PCIe 配置空间时按照 PCIe 总线标准配置 TLP 请求，CFG_DATA 是读取的数据或者待写入的数据。<br><img data-src="picture2.jpg" alt=""><br>图 2</p><p>31 位：Enable 位，为 1 时，对 CFG_DATA 读写才能转换成 PCIe 总线配置请求。<br>30~24 位：保留。<br>23~16 位：总线号，最多 = 256 个。<br>15~11 位：设备号，最多 = 32 个。<br>10~8 位：功能号，最多 = 8 个。<br>7~2 位：寄存器偏移，最多访问寄存器 = 64 个地址，这里一个地址是 DW，那么能干访问的 PCIe 配置空间大小为 64*4=256Byte，所以访问 PCIe 配置空间都是以 4 字节对齐访问的。<br>走到这里很多读者可能就会有这样的疑问，既然 CPU 能够直接通过寄存器访问配置空间，为啥还会出现配置空间在存储域地址的映射这一说法呢？下面给出详细解答。</p><p>访问 PCIe 配置空间寄存器的方法需要追溯到原始的 PCI 规范。为了发起 PCI 总线配置周期，Intel（Intel 是 PCIe 龙头老大，最新的 PCIe 的规范总是它最先尝试的）实现的 PCI 规范使用 IO 空间的 CF8h 和 CFCh 来分别作为索引和数据寄存器，这种方法可以访问所有 PCI 设备的 255 bytes 配置寄存器。Intel Chipsets 目前仍然支持这种访 PCI 配置空间的方法。PCIe 规范在 PCI 规范的基础上，将配置空间扩展到 4K bytes，至于为什么扩展到 4K，具体可以参考 PCIe 规范，这些配置 CFG_ADDR 和 CFG_DATA 寄存器方法仍然可以访问所有 PCIe 设备配置空间的头 255 bytes，但是该方法访问不了剩下的（255B~4K）配置空间。怎么办呢？Intel 外一种 PCIe 配置空间访问方法。Intel Chipset 通过将配置空间映射到内存地址空间，PCIe 配置空间可以像对映射范围内的内存进行 read/write 来访问了。这种映射是由北桥芯片来完成的，但是不同芯片的映射方式也是不同的。目前我查看了 ARM 芯片的 datasheet，确实是这样的方式。</p><p>PCIe 规范为每个 PCIe 设备添加了更多的配置寄存器，空间为 4K，尽管 CFG_ADDR 和 CFG_DATA 寄存器方法仍然能够访问 lower 255 bytes，但是必须提供另外一种方法来访问剩下的（255B~4K）range 寄存器。Intel 的解决方案是使用了预留 256MB 内存地址空间，对这段内存的任何访问都会发起 PCIe 配置 cycle。由于 4K 的配置空间是 directly mapped to memory 的，那么 PCIe 规范必须保证所有的 PCIe 设备的配置空间占用不同的内存地址，按照 PCIe 规范，支持最多 256 个 bus，每个 Bus 支持最多 32 个 PCIe devices，每个 device 支持最多 8 个 function, 也就是说：占用内存的最大值为：256 * 32 * 8 * 4K = 256MB。图 3 是 ARM Cortex-A9 datasheet 内存地址分配局部图。被 PCIe 配置空间占用的 256M 内存空间会屏蔽掉 DRAM 使用该段内存区，这些地址都由 CPU 出厂时已经固化好了。<br><img data-src="picture3.jpg" alt=""><br>图 3</p><p>PCIe 配置空间的内存映射对 32bit 系统的影响<br>由于 PCIe 配置空间占用了 256M 内存空间，而且该被占用空间对 DRAM 来说是不可用的，这意味着 256M 空间消失于系统内存，这在 32bit 系统中更为明显。比如，在 32 bit winxp 中（作者目前电脑还是用的 XP 系统，电脑用了七八年了），理论上可以访问到的内存是 4G，如果 4G 空间都被 DRAM 给占用，由于 PCIe 的存在，被 PCIe 占用的那部分内存空间对 OS 来说是不可用的，莫名的消失了最多 256M 内存，其实还有其他外设寄存器需要映射到内存，如果是独立编址就不存在寄存器占用内存。所以在 XP 系统中实际能够访问 DRAM 空间最大值为 3.2G。64 位 CPU 寻址不存在这个情况，个地址目前来说应该用不完，这里读者需要注意的是 CPU 有 32 和 64 位寻址方式，同样操作系统也有 32 和 64 位之分，在 Linux 系统中主要体现在库文件上。</p><p>有些 CPU 没有直接指定 PCIe 配置空间的地址范围，需要读取某个寄存器的值 BaseAddr，这个值就说 PCIe 配置寄存器在内存区域映射的基地址。访问 PCIe 设备配置空间时候需要手动计算访问 PCIe 配置空间的地址。计算发放如下:</p><p>SIZE_PER_FUNC = 4K = 1000h</p><p>SIZE_PER_DEVICE = 4K * 8 = 8000h</p><p>SIZE_PER_BUS = 4K <em>8</em> 32 = 100000h</p><p>访问总线号为 busNo，设备号为 DevNo，功能号为 funcNo 的 offset 寄存器的计算公式是：</p><p>Memory Address = BaseAddr+ busNo * SIZE_PER_BUS+ devNo * SIZE_PER_DEVICE+ funcNo * SIZE_PER_FUNC+ offset</p><p>访问 PCIe 配置空间就需要通过总线号、设备号、功能号、寄存器偏移进行转换成内存地址。转换函数如图 2 所示。<br><img data-src="picture4.jpg" alt=""><br>图 4</p><p>问题 4 和 5 在下面文章中讲解，介于作者实力有限。如有错误，望读者给出宝贵的意见。</p><p>剩下两个问题，上电扫描 PCIe 树和存储地址到 PCIe 地址的映射，本篇文章将对这两个问题做出解答。本文可能会针对某一款芯片做出详细流程解答，读者可以只关注整个流程，具体映射机制和寄存器参考芯片 datasheet。上篇文章已经了解到如何访问配置空间，前 256Bytes 可以通过寄存器方式访问，后面的 256B~4k 必须通过映射才能访问，映射无非就是把配置空间映射到存储地址空间，或者把 PCIe 设备空间映射到存储地址空间。下面开始讨论映射关系。</p><p>地址映射关系<br>PCIe 在存储域地址空间分为三部分，PCIe 控制器本身的寄存器、PCIe 设备的配置空间、PCIe 设备空间。寄存器和配置空间由处理器本身决定存储地址范围，本款处理器地址范围如图 1 所示，配置空间地址、寄存器地址、内存地址都已经确定。PCIe 设备空间需要编程人员去配置 Outbound 和 Inbound 寄存器组，确定映射关系<br><img data-src="picture5.jpg" alt=""><br>图 5</p><p>Outbound 在 PCIe 控制器中扮演的角色是将存储地址翻译到 PCIe 域的 PCIe 地址，Inbound 是将 PCIe 地址翻译成存储地址，图 2 是一个完整的 RC 和 EP 模型地址翻译模型，图中的地址数字仅仅代表一种形态，具体地址应该是什么在后文中讲解。当 cpu 需要访问 EP 的内存空间时，首先应该将存储地址转换成 PCIe 地址，在根据 TLP 到达指定的 EP，进而将 PCIe 地址转换成 EP 端的存储地址。<br><img data-src="picture6.jpg" alt=""><br>图 6</p><p>PCIe 地址到存储地址之间的映射关系由三个寄存器决定（有两个寄存器组应该是 32 个寄存器）OB_SIZE、OB_OFFSET_INDEXn、OB_OFFSETn_HI，n 的范围是 0~31。在 PCIe 控制器中是把 PCIe 地址等分成 32 块 regions (Regions 0 to 31)，每个 regions 的大小是可以通过编程设置 OB_SIZE 寄存器确定大小，大小有 1, 2, 4, or 8 MB，那么通过 Outbound 能够翻译的地址最大为 8M*32=256M。存储域地址中有 5 位作为识别 32 个 regions 的 index，OB_SIZE 的大小决定这 5 位在 32 位地址上的位置。当 OB_SIZE 等于 0，1，2，3 时，index 在存储地址中对应的位置是 Bits [24:20], bits [25:21], bits [26:22], and bits [27:23]，每个 regions 翻倍，是不是对应的地址应该按翻倍对齐呢，翻倍就是左移一位数据。OB_SIZE 寄存器如图 3 所示。<br><img data-src="picture7.jpg" alt="">                                                                                      图 7</p><p>OB_OFFSET_INDEXn 寄存器结构如图 4 所示，n 是上一段落提到的 index 的值。该寄存器第 0 位是地址翻译使能位，第 31<sub>20 位是第 n 个 regions 的基地址的 31</sub>20 位，这里的取值取决 regions 的大小，当 OB_SIZE 等于 0，1，2，3 时，bits [31:20], bits [31:21], bits [31:22], and bits [31:23] 位相应被使用。OB_OFFSETn_HI 寄存器的值是 64 位 PCIe 地址中第 n 个 regions 的基地址的 63~32 位，在 32 位 PCIe 地址中，该寄存器的值等于 0。<br><img data-src="picture8.jpg" alt=""><br>图 8</p><p>配置 OutBound 翻译的几个寄存器也做了详解，下面根据举例说明。图 5 中配置空间存储地址由 CPU 本身架构所决定，这部分的地址映射才芯片内部完成，不需要由编程人员配置。PCIe 设备空间被分成了 32 等分。假设 region 大小是 2M，PCIe 地址是 64 位，程序中需要对 0x9D3A_1234 存储地址做映射， 64 位 PCIe 地址被使用在 region 9 上，初始化 OBOFFSET9_HI 值为 0x3344 5566, OB_OFFSET9 值 56Ex xxxx（x 的值这里不关心，看该寄存器结构就很清楚，第 0 位在地址翻译时候应该使能位 1，这里仅仅用来讲解怎么做映射，不需要关心后面的 Bits） ，下面分析怎么翻译到 PCIe 地址：</p><p>由于是 regions 大小 2M，那么 index 应该取地址的 bits [25:21]，提取 0x9D3A_1234 存储地址的 bits [25:21 得到 01001b，该值等于 9，那么该地址应该启用 regions 9 翻译。存储地址的 bits [20:00] 是用做翻译到 PCIe 地址的 bits [20:00] 位，该值也可以理解成 reginos 9 内的偏移值，值是 0x001A 1234。<br>生成 regions 块 PCIe 的基地址，该地址应 pcie_base=OBOFFSET9_HI &lt;&lt;32 + OB_OFFSET9 的 bits [31:21] = 0x 3344 5566 56E0 0000。<br>计算 PCIe 地址，pcie_addr = pcie_base + 存储地址 bits [20:0] =0x3344 5566 56FA 1234。<br><img data-src="picture9.jpg" alt=""><br>图 9</p><p>从上面存储地址到 PCIe 地址映射可以看到，通过 cpu 寻址可以直接访问到 PCIe 设备空间，最多可以访问 PCIe 设备空间大小为 256M，具体 Outbound 能够访问的大小根据芯片而定，当 CPU 与 FPGA 之间有大量数据交互时候也可以采用 Inbound 方式（Inbound 地址翻译流程如图 6 所示，这里就不在翻译），将 CPU 的内存映射到 FPGA 的寻址空间（这里是站在 CPU 角度看的，从图 2 可以理解具体映射大小还由 EP 决定），FPGA 可以采用 DMA 方式访问 cpu 的内存，并且速度很快。有些芯片厂商干脆采用同核异构方式将 CPU 于 FPGA 集成在一起（有的将 cpu 与 dsp 集成在一起），两者之间采用 AXI 高速总线通讯。<br><img data-src="picture10.jpg" alt="">                                                                                    \ 图 10</p><p>扫描 PCIe 树<br>扫描树的流程如下：</p><p>建立存储地址到 PCIe 地址映射 （映射方式上面段落已经讲解了，固定的 PCIe 配置空间映射）<br>分配 PCIe 总线号<br>分配设备号<br>访问配置空间 （这里有一个原则读者需要注意，对 PCIe 设备配置空间访问时，一定要确定总线号、设备号、功能号、寄存器，不然无法找到设备）<br>读写 BAR0 确定 PCIe 设备 1 空间大小<br>分配 PCIe 地址<br>分配总线号<br>扫描 PCIe 总线树时，需要对这些 PCIe 总线进行编号，即初始化 PCIe 桥（在本文一律指透明桥）的 Primary、Secondary 和 Subordinate Bus 寄存器。在 Linux 内核中采用 DFS 算法对 PCIe 总线树进行遍历，DFS 算法是按照深度优先的原则遍历 PCIe 树，局部代码如图 7 所示，这里可以跟踪 pci_scan_bridge 函数，函数采用 DFS 算法对总线进行编号（后期会讲解搜索树，比较常见 hash 表、红黑树）。<br><img data-src="picture11.jpg" alt=""><br>图 11</p><p>分配设备号<br>PCIe 设备的 IDSEL 信号与 PCIe 总线的 AD [31:0] 信号的连接关系决定了该设备在这条总线上的设备号。在配置读写总线事务的地址周期中，AD [10:0] 已经被信号已经被功能号和寄存器号使用，因此 PCIe 设备的 IDSEL 只能与 AD [31:11] 信号连接。上一篇文章中谈到 CONFIG_ADDR 寄存器中的 Device Number 字段一共有 5 位，最大能够表示 32 个设备，这里只有 21 位，显然在两者之间不能建立一一映射关系。一个 PCIe 总线号下最多可以挂在 21 个 PCIe 设备，那么多个 PCIe 总线不就可以挂载 32 个设备了么。</p><p>访问配置空间<br>在 32 位 PCIe 地址空间中，PCIe 设备通常将 PCIe 配置存放在 E2PROM 中，PCIe 设备进行上电初始化时，将 E2PROM 中的信息读到 PCIe 设备的配置空间作为初始值，由硬件自动完成。BAR0 空间存储了 PCIe 设备空间的大小，某些位被设置成不可预读，当 BAR0 全部写入 1 时，然后在读取 BAR0 值，从数据低位看有多少连续位没有改变。没有改变的数据位数记录的该 PCIe 设备空间的大小，假如有 n 位没有改变，那么设备空间大小应该是 2 的 n 次方。第 0 位代表 IO/Memory、第 2，3 位代表 32/64 位地址、第 4 位代表是否可预取，具体位定义格式可以直接参考内核 PCIe 总线代码，解析 BAR 函数如图 8 所示。<br><img data-src="picture12.jpg" alt=""><br>图 12</p><p>分配 PCIe 地址<br>系统软件根据根据设备空间大小建立存储地址 PCIe 设备地址空间的映射，给 PCIe 设备分配的 PCIe 基地址写入到 BAR0，如果是 64 位 PCIe 地址，那么 BAR1 是高 32 位地址。</p><p>结语<br>写《从 cpu 角度理解 PCIe》文章我参考了部分芯片的 datasheet，并结合 linux 代码分析，本文仅仅起到分析流程的作用，具体映射机制和寄存器芯片参考相应芯片 datasheet。如有错误，还望指正。</p></div><footer><div class="meta"></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Kung-Fu-Master 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Kung-Fu-Master 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="Kung-Fu-Master 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Kung-Fu-Master <i class="ic i-at"><em>@</em></i>Hexo</li><li class="link"><strong>本文链接：</strong> <a href="https://kung-fu-master.github.io/2021/03/13/linux/CPU%E8%A7%92%E5%BA%A6%E7%90%86%E8%A7%A3PCIE/" title="CPU角度理解PCIE">https://kung-fu-master.github.io/2021/03/13/linux/CPU角度理解PCIE/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/03/13/linux/BIOS/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclga70tsj20zk0m84mr.jpg" title="BIOS"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> linux</span><h3>BIOS</h3></a></div><div class="item right"><a href="/2021/03/13/linux/U%E7%9B%98%E5%88%86%E5%8C%BA%E4%B9%8B%E5%90%8E%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipeyhsblkj20zk0m81kx.jpg" title="U盘制作启动盘分区后恢复"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> linux</span><h3>U盘制作启动盘分区后恢复</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2021/03/13/linux/CPU%E8%A7%92%E5%BA%A6%E7%90%86%E8%A7%A3PCIE/" rel="bookmark" title="CPU角度理解PCIE">CPU角度理解PCIE</a></li><li><a href="/2021/03/13/linux/BIOS/" rel="bookmark" title="BIOS">BIOS</a></li><li><a href="/2021/03/13/linux/ACPI%E6%98%AF%E4%BB%80%E4%B9%88&BIOS%E4%B8%ADACPI%E8%A6%81%E6%80%8E%E4%B9%88%E8%AE%BE%E7%BD%AE/" rel="bookmark" title="ACPI是什么,BIOS中ACPI要怎么设置">ACPI是什么,BIOS中ACPI要怎么设置</a></li><li><a href="/2021/03/13/linux/Intel_pstate-acpi-cpufreq%E9%A9%B1%E5%8A%A8%E5%88%87%E6%8D%A2/" rel="bookmark" title="Intel_pstate/acpi-cpufreq驱动切换">Intel_pstate/acpi-cpufreq驱动切换</a></li><li><a href="/2021/03/13/linux/Linux_kernel_userspace%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" rel="bookmark" title="Linux kernel userspace体系结构">Linux kernel userspace体系结构</a></li><li><a href="/2021/03/13/linux/PTU(Power%20Thermal%20Utility)/" rel="bookmark" title="PTU(Power Thermal Utility)">PTU(Power Thermal Utility)</a></li><li><a href="/2021/03/13/linux/TSC/" rel="bookmark" title="TSC">TSC</a></li><li><a href="/2021/03/13/linux/U%E7%9B%98RAW%E7%B1%BB%E5%9E%8B%E4%BF%AE%E5%A4%8D/" rel="bookmark" title="U盘RAW类型修复">U盘RAW类型修复</a></li><li><a href="/2021/03/13/linux/U%E7%9B%98%E5%88%86%E5%8C%BA%E4%B9%8B%E5%90%8E%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D/" rel="bookmark" title="U盘制作启动盘分区后恢复">U盘制作启动盘分区后恢复</a></li><li><a href="/2021/03/13/linux/VirtualBox%E5%AE%89%E8%A3%85Centos7/" rel="bookmark" title="VirutalBos安装Centos7">VirutalBos安装Centos7</a></li><li><a href="/2021/03/13/linux/Windows10mstsc%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95Centos7.0/" rel="bookmark" title="Windows10 mstsc远程登录Centos7.0">Windows10 mstsc远程登录Centos7.0</a></li><li><a href="/2021/03/13/linux/centos%E5%8D%87%E7%BA%A7gcc%E5%88%B09.1.0/" rel="bookmark" title="centos升级gcc到9.1.0">centos升级gcc到9.1.0</a></li><li><a href="/2021/03/13/linux/emon/" rel="bookmark" title="emon">emon</a></li><li><a href="/2021/03/13/linux/intel_pstate-acpi-cpufreq%E9%A9%B1%E5%8A%A8%E7%A0%94%E7%A9%B6/" rel="bookmark" title="intel_pstate/acpi-cpufreq驱动研究">intel_pstate/acpi-cpufreq驱动研究</a></li><li><a href="/2021/03/13/linux/ln%E8%BD%AF%E8%BF%9E%E6%8E%A5_head_tail_more_less/" rel="bookmark" title="ln软连接, head, tail, more&less">ln软连接, head, tail, more&less</a></li><li><a href="/2021/03/13/linux/sda_hda/" rel="bookmark" title="sda hda">sda hda</a></li><li><a href="/2021/03/13/linux/wget_www.baidu.com/" rel="bookmark" title="wget www.baidu.com">wget www.baidu.com</a></li><li><a href="/2021/03/13/linux/yum%E4%B8%8B%E8%BD%BD%E9%81%87%E5%88%B0XZ_5.1.2alpha%E9%97%AE%E9%A2%98/" rel="bookmark" title="yum下载遇到XZ_5.1.2alpha问题">yum下载遇到XZ_5.1.2alpha问题</a></li><li><a href="/2021/03/13/linux/yum%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" rel="bookmark" title="yum 遇到的问题">yum 遇到的问题</a></li><li><a href="/2021/03/13/linux/yum%E4%BD%BF%E7%94%A8%E5%92%8C%E5%AE%89%E8%A3%85cmake-3%E7%89%88%E6%9C%AC%E4%B8%8A/" rel="bookmark" title="yum使用和安装cmake 3 版本上">yum使用和安装cmake 3 版本上</a></li><li><a href="/2021/03/13/linux/%E4%BF%AE%E6%94%B9os%E6%97%B6%E9%97%B4%E6%97%B6%E5%8C%BA/" rel="bookmark" title="linux 修改系统时间时区">linux 修改系统时间时区</a></li><li><a href="/2021/03/13/linux/%E6%8C%89%E5%AD%97%E8%8A%82-%E5%AD%97%E5%AF%BB%E5%9D%80_%E5%AD%97%E9%95%BF_%E5%9C%B0%E5%9D%80%E6%80%BB%E7%BA%BF_%E6%95%B0%E6%8D%AE%E6%80%BB%E7%BA%BF%E5%85%B3%E7%B3%BB/" rel="bookmark" title="按字节/字寻址，字长，地址总线，数据总线关系">按字节/字寻址，字长，地址总线，数据总线关系</a></li><li><a href="/2021/03/13/linux/%E6%9F%A5%E7%9C%8BSSD/" rel="bookmark" title="查看SSD">查看SSD</a></li><li><a href="/2021/03/13/linux/%E7%94%A8%E6%88%B7%E6%80%81%E5%92%8C%E5%86%85%E6%A0%B8%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98-%E4%BD%BF%E7%94%A8dev_mem&mmap/" rel="bookmark" title="用户态和内核共享内存----使用 /dev/mem & mmap">用户态和内核共享内存----使用 /dev/mem & mmap</a></li><li><a href="/2021/03/13/linux/%E7%A1%AC%E7%9B%98%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E5%8D%95%E4%BD%8DGB/" rel="bookmark" title="硬盘存储空间单位GB">硬盘存储空间单位GB</a></li><li><a href="/2021/03/13/linux/%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E9%94%99%E8%AF%AF_r_command%20not%20found/" rel="bookmark" title="脚本执行错误 $'\r':command not found">脚本执行错误 $'\r':command not found</a></li><li><a href="/2021/03/13/linux/%E8%BF%9E%E6%8E%A5router%E5%90%8E%E6%9C%BA%E5%99%A8%E8%BF%9E%E4%B8%8D%E4%B8%8A%E5%A4%96%E7%BD%91/" rel="bookmark" title="连接router后机器连不上外网">连接router后机器连不上外网</a></li><li><a href="/2021/03/13/linux/Centos%E5%AE%89%E8%A3%85chrome/" rel="bookmark" title="Centos安装chrome">Centos安装chrome</a></li><li><a href="/2021/03/13/linux/Centos%E6%9B%B4%E6%94%B9kernel%20%E9%BB%98%E8%AE%A4%E5%90%AF%E5%8A%A8%E9%A1%B9/" rel="bookmark" title="Centos 更改kernel 默认启动项">Centos 更改kernel 默认启动项</a></li><li><a href="/2021/03/13/linux/Devtoolset%20%E5%8D%87%E7%BA%A7gcc%E5%88%B08.3.1/" rel="bookmark" title="Devtoolset 升级gcc到8.3.1">Devtoolset 升级gcc到8.3.1</a></li><li><a href="/2021/03/13/linux/Linux_kernel_%E6%9B%B4%E6%96%B0/" rel="bookmark" title="Linux kernel 更新">Linux kernel 更新</a></li><li><a href="/2021/03/13/linux/Linux%20%E4%BF%AE%E6%94%B9root%E5%90%8D%E7%A7%B0/" rel="bookmark" title="Linux 修改root名称">Linux 修改root名称</a></li><li><a href="/2021/03/13/linux/Intel_pstate&HWP%E5%8A%9F%E8%83%BDenable_disable/" rel="bookmark" title="Intel_pstate & HWP功能enable/disable">Intel_pstate & HWP功能enable/disable</a></li><li><a href="/2021/03/13/linux/Linux%E4%B8%8B%E5%91%BD%E4%BB%A4Is%E5%92%8C%E5%91%BD%E4%BB%A4dir%E7%9A%84%E5%8C%BA%E5%88%AB/" rel="bookmark" title="Linux下命令Is和命令dir的区别">Linux下命令Is和命令dir的区别</a></li><li><a href="/2021/03/13/linux/EOF/" rel="bookmark" title="EOF">EOF</a></li><li><a href="/2021/03/13/linux/Makefile/" rel="bookmark" title="Makefile">Makefile</a></li><li><a href="/2021/03/13/linux/MMIO/" rel="bookmark" title="MMIO">MMIO</a></li><li><a href="/2021/03/13/linux/RHEL8.0%E5%BC%80%E6%9C%BA%E6%80%BB%E6%98%AF%E8%A6%81dhclient%E6%89%8B%E5%8A%A8%E8%8E%B7%E5%8F%96IP/" rel="bookmark" title="RHEL8.0开机总是要dhclient手动获取IP">RHEL8.0开机总是要dhclient手动获取IP</a></li><li><a href="/2021/03/13/linux/alias/" rel="bookmark" title="alias">alias</a></li><li><a href="/2021/03/13/linux/U%E7%9B%98%E5%AE%89%E8%A3%85OS/" rel="bookmark" title="U盘安装OS">U盘安装OS</a></li><li><a href="/2021/03/13/linux/awk_sed_find_grep/" rel="bookmark" title="awk, sed, find, grep">awk, sed, find, grep</a></li><li><a href="/2021/03/13/linux/cmake/" rel="bookmark" title="cmake">cmake</a></li><li><a href="/2021/03/13/linux/Ubuntu%E4%B8%8B%E5%AE%89%E8%A3%85CUDA8.0%E5%8F%8Anvidia%E9%A9%B1%E5%8A%A8(%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B)/" rel="bookmark" title="Ubuntu下安装CUDA8.0及nvidia驱动(详细教程）">Ubuntu下安装CUDA8.0及nvidia驱动(详细教程）</a></li><li><a href="/2021/03/13/linux/curl_wget/" rel="bookmark" title="curl & wget">curl & wget</a></li><li><a href="/2021/03/13/linux/cppc%E5%8A%A8%E6%80%81%E8%B0%83%E9%A2%91/" rel="bookmark" title="cppc动态调频">cppc动态调频</a></li><li><a href="/2021/03/13/linux/chown/" rel="bookmark" title="chown改变文件所属用户和用户组">chown改变文件所属用户和用户组</a></li><li><a href="/2021/03/13/linux/dmidecode/" rel="bookmark" title="dmidecode">dmidecode</a></li><li><a href="/2021/03/13/linux/docker/" rel="bookmark" title="docker">docker</a></li><li><a href="/2021/03/13/linux/dd_command/" rel="bookmark" title="dd 命令">dd 命令</a></li><li><a href="/2021/03/13/linux/cut/" rel="bookmark" title="cut">cut</a></li><li><a href="/2021/03/13/linux/curl%E5%8D%87%E7%BA%A7/" rel="bookmark" title="curl 升级">curl 升级</a></li><li><a href="/2021/03/13/linux/etc_profile-etc_bashrc-~.bashrc/" rel="bookmark" title="/etc/profile, /etc/bashrc, ~/.bashrc">/etc/profile, /etc/bashrc, ~/.bashrc</a></li><li><a href="/2021/03/13/linux/gdb/" rel="bookmark" title="gdb">gdb</a></li><li><a href="/2021/03/13/linux/helm/" rel="bookmark" title="helm安装">helm安装</a></li><li><a href="/2021/03/13/linux/history/" rel="bookmark" title="Linux中禁用命令历史记录">Linux中禁用命令历史记录</a></li><li><a href="/2021/03/13/linux/jq_json%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7/" rel="bookmark" title="jq json解析工具">jq json解析工具</a></li><li><a href="/2021/03/13/linux/getopt_getopts_%E8%A7%A3%E6%9E%90%E5%91%BD%E4%BB%A4%E9%95%BF%E5%8F%82%E6%95%B0/" rel="bookmark" title="getopt,getopts解析命令行长参数">getopt,getopts解析命令行长参数</a></li><li><a href="/2021/03/13/linux/expect%E6%89%A7%E8%A1%8C%E4%B8%8E%E7%BB%88%E7%AB%AF%E7%9A%84%E4%BA%A4%E4%BA%92%E6%93%8D%E4%BD%9C/" rel="bookmark" title="expect 执行与终端的交互操作">expect 执行与终端的交互操作</a></li><li><a href="/2021/03/13/linux/linux%E5%88%B6%E4%BD%9CU%E7%9B%98%E5%90%AF%E5%8A%A8%E7%9B%98/" rel="bookmark" title="linux制作U盘启动盘">linux制作U盘启动盘</a></li><li><a href="/2021/03/13/linux/java%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8D%B8%E8%BD%BD/" rel="bookmark" title="java安装与卸载">java安装与卸载</a></li><li><a href="/2021/03/13/linux/linux%E6%97%A5%E5%BF%97_%E6%9C%8D%E5%8A%A1%E6%97%A5%E5%BF%97/" rel="bookmark" title="查看 linux 系统日志 和 服务的日志">查看 linux 系统日志 和 服务的日志</a></li><li><a href="/2021/03/13/linux/linux%E6%9F%A5%E7%9C%8B%E8%BF%90%E8%A1%8C%E7%9A%84%E6%9C%8D%E5%8A%A1/" rel="bookmark" title="linux查看运行的服务">linux查看运行的服务</a></li><li><a href="/2021/03/13/linux/maven/" rel="bookmark" title="maven">maven</a></li><li><a href="/2021/03/13/linux/linux%E5%90%91%E5%85%B6%E5%AE%83%E7%BB%88%E7%AB%AF%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF/" rel="bookmark" title="linux向其它终端发送消息">linux向其它终端发送消息</a></li><li><a href="/2021/03/13/linux/linux%E7%BB%99grub%E6%B7%BB%E5%8A%A0%E5%86%85%E6%A0%B8%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0/" rel="bookmark" title="linux给grub添加内核启动参数">linux给grub添加内核启动参数</a></li><li><a href="/2021/03/13/linux/nginx/" rel="bookmark" title="nginx">nginx</a></li><li><a href="/2021/03/13/linux/ntpdate_synchronize_os_time/" rel="bookmark" title="ntpdate 同步各个系统时间">ntpdate 同步各个系统时间</a></li><li><a href="/2021/03/13/linux/perf/" rel="bookmark" title="perf">perf</a></li><li><a href="/2021/03/13/linux/python%E5%AE%89%E8%A3%85/" rel="bookmark" title="python 安装">python 安装</a></li><li><a href="/2021/03/13/linux/scp%E6%9C%BA%E5%99%A8%E9%97%B4%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/" rel="bookmark" title="scp机器间复制文件">scp机器间复制文件</a></li><li><a href="/2021/03/13/linux/screen%E7%A8%8B%E5%BA%8F%E5%9C%A8%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C/" rel="bookmark" title="screen程序在后台运行">screen程序在后台运行</a></li><li><a href="/2021/03/13/linux/linux%E6%B7%BB%E5%8A%A0%E4%BF%AE%E6%94%B9%E7%BD%91%E7%BB%9C%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E8%AE%BE%E5%A4%87/" rel="bookmark" title="linux添加修改网络命名空间设备">linux添加修改网络命名空间设备</a></li><li><a href="/2021/03/13/linux/rpm_yum/" rel="bookmark" title="RPM, yum">RPM, yum</a></li><li><a href="/2021/03/13/linux/nc_netstat_tee/" rel="bookmark" title="nc, netstat, tee">nc, netstat, tee</a></li><li><a href="/2021/03/13/linux/vim/" rel="bookmark" title="vim">vim</a></li><li><a href="/2021/03/13/linux/tmux%E6%93%8D%E4%BD%9C/" rel="bookmark" title="tmux 操作">tmux 操作</a></li><li><a href="/2021/03/13/linux/time/" rel="bookmark" title="time">time</a></li><li><a href="/2021/03/13/linux/%E8%A7%A3%E5%8E%8B%E7%BC%A9%E5%91%BD%E4%BB%A4%E5%90%88%E9%9B%86/" rel="bookmark" title="解压缩命令合集">解压缩命令合集</a></li><li><a href="/2021/03/13/linux/ssh-keygen_%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86/" rel="bookmark" title="ssh-keygen,known_hosts 免密登陆">ssh-keygen,known_hosts 免密登陆</a></li><li><a href="/2021/03/17/linux/%E9%87%8D%E5%90%AFlinux%E6%9C%BA%E5%99%A8/" rel="bookmark" title="重启linux机器">重启linux机器</a></li><li><a href="/2021/03/25/linux/vnc/" rel="bookmark" title="vnc 远程连接Centos桌面">vnc 远程连接Centos桌面</a></li><li><a href="/2021/05/31/linux/fdisk%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA_mount/" rel="bookmark" title="fdisk磁盘分区 mount操作">fdisk磁盘分区 mount操作</a></li><li><a href="/2021/05/31/linux/mstsc_remote_desktop/" rel="bookmark" title="mstsc xrdp 远程连接linux桌面">mstsc xrdp 远程连接linux桌面</a></li><li><a href="/2021/05/31/linux/ssh%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84/" rel="bookmark" title="ssh端口映射">ssh端口映射</a></li><li><a href="/2021/05/31/linux/sftp_transfer_files/" rel="bookmark" title="sftp transfer files">sftp transfer files</a></li><li><a href="/2021/05/31/linux/%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA_mount/" rel="bookmark" title="磁盘分区fdisk, parted, mount操作">磁盘分区fdisk, parted, mount操作</a></li><li><a href="/2021/06/01/linux/shell/" rel="bookmark" title="shell">shell</a></li><li><a href="/2021/06/03/linux/mount_umount/" rel="bookmark" title="mount/umount">mount/umount</a></li><li><a href="/2021/06/07/linux/environment_variable/" rel="bookmark" title="环境变量加载顺序">环境变量加载顺序</a></li><li><a href="/2021/06/09/linux/xargs/" rel="bookmark" title="xargs">xargs</a></li><li><a href="/2021/06/10/linux/shrink_home_and_expand_root_space/" rel="bookmark" title="缩小home并扩充增大root和根目录空间">缩小home并扩充增大root和根目录空间</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Kung-Fu-Master" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Kung-Fu-Master</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">331</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">42</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">14</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lvdXJuYW1l" title="https:&#x2F;&#x2F;github.com&#x2F;yourname"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJpZA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourid"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/03/13/linux/BIOS/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/03/13/linux/U%E7%9B%98%E5%88%86%E5%8C%BA%E4%B9%8B%E5%90%8E%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/language/" title="分类于 language">language</a> <i class="ic i-angle-right"></i> <a href="/categories/language/c/" title="分类于 c">c</a></div><span><a href="/2021/06/21/language/c/memoryManagement/" title="c Memory Management">c Memory Management</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/storage/" title="分类于 storage">storage</a> <i class="ic i-angle-right"></i> <a href="/categories/storage/minio/" title="分类于 minio">minio</a></div><span><a href="/2021/03/13/storage/minio/minIO_03_client.md/" title="MinIO 03 client">MinIO 03 client</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/language/" title="分类于 language">language</a> <i class="ic i-angle-right"></i> <a href="/categories/language/c/" title="分类于 c">c</a></div><span><a href="/2021/03/13/language/c/thread-pool/" title="The thread pool of c">The thread pool of c</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/blogs/" title="分类于 blogs">blogs</a> <i class="ic i-angle-right"></i> <a href="/categories/blogs/blogs/" title="分类于 blogs">blogs</a></div><span><a href="/2021/03/13/blogs/blogs/markdown%E6%94%AF%E6%8C%81%E9%AB%98%E4%BA%AE%E6%98%BE%E7%A4%BA%E7%9A%84%E8%AF%AD%E8%A8%80/" title="markdown支持高亮显示的语言">markdown支持高亮显示的语言</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/reference/" title="分类于 reference">reference</a> <i class="ic i-angle-right"></i> <a href="/categories/reference/k8s/" title="分类于 k8s">k8s</a></div><span><a href="/2021/03/13/reference/k8s/22.%E6%92%AC%E5%8A%A8%E7%A6%BB%E7%BA%BF%E4%B8%9A%E5%8A%A1%EF%BC%9AJob%E4%B8%8ECronJob/" title="22 | 撬动离线业务：Job与CronJob">22 | 撬动离线业务：Job与CronJob</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/microService/" title="分类于 microService">microService</a> <i class="ic i-angle-right"></i> <a href="/categories/microService/kubernetes/" title="分类于 kubernetes">kubernetes</a></div><span><a href="/2021/05/31/microService/kubernetes/01_kubernetes_high_availablity_build/" title="01 Kubernetes build high availability">01 Kubernetes build high availability</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/microService/" title="分类于 microService">microService</a> <i class="ic i-angle-right"></i> <a href="/categories/microService/kubernetes/" title="分类于 kubernetes">kubernetes</a></div><span><a href="/2021/03/13/microService/kubernetes/09_kubernetes_certificate/" title="09 Kubernetes Certificates">09 Kubernetes Certificates</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/blogs/" title="分类于 blogs">blogs</a> <i class="ic i-angle-right"></i> <a href="/categories/blogs/blogs/" title="分类于 blogs">blogs</a></div><span><a href="/2021/03/13/blogs/blogs/HTTP_TCP_Socket_grpc/" title="HTTP, TCP, Socket, grpc">HTTP, TCP, Socket, grpc</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/microService/" title="分类于 microService">microService</a> <i class="ic i-angle-right"></i> <a href="/categories/microService/istio/" title="分类于 istio">istio</a></div><span><a href="/2021/03/13/microService/istio/istio_02_installation_upgrade/" title="Istio 02 Installation and upgrade">Istio 02 Installation and upgrade</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/technologies/" title="分类于 technologies">technologies</a> <i class="ic i-angle-right"></i> <a href="/categories/technologies/web%E5%89%8D%E7%AB%AF/" title="分类于 web前端">web前端</a></div><span><a href="/2021/03/13/technologies/web/datatables/" title="web前端datatables框架">web前端datatables框架</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Kung-Fu-Master @ Kung Fu Master</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">1.3m 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">19:06</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/03/13/linux/CPU角度理解PCIE/",favicon:{show:"（●´3｀●）",hide:"（●´3｀●）"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->